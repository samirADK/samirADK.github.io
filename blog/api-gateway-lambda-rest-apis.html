<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://img.icons8.com/ios-filled/50/000000/infinity.png" type="image/png">
    <title>Building Production-Ready REST APIs with API Gateway and Lambda - Samir Adhikari</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NQYZ1YTN96"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NQYZ1YTN96');
</script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap');

        /* Light Theme Variables */
        :root {
            --bg-primary: #f8f8f8;
            --bg-secondary: #ffffff;
            --bg-accent: #f0f0f0;
            --text-primary: #222222;
            --text-secondary: #555555;
            --accent-color: #6e56cf;
            --accent-hover: #8a6eff;
            --accent-muted: rgba(110, 86, 207, 0.2);
            --gradient-1: linear-gradient(135deg, #6e56cf 0%, #b86eff 100%);
            --gradient-2: linear-gradient(135deg, #f0f0f0 0%, #ffffff 100%);
            --shadow-sm: 0 5px 15px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 10px 30px rgba(0, 0, 0, 0.2);
            --shadow-glow: 0 0 15px rgba(110, 86, 207, 0.2);
            --card-border: 1px solid #e0e0e0;
            --neon-glow: 0 0 10px rgba(110, 86, 207, 0.3), 0 0 20px rgba(110, 86, 207, 0.1);
            --header-bg: rgba(255, 255, 255, 0.9);
            --switch-bg: #e0e0e0;
            --switch-thumb: #ffffff;
            --switch-icon-color: #6e56cf;
            --footer-divider: #e0e0e0;
            --scrollbar-track: #f0f0f0;
            --scrollbar-thumb: #cccccc;
        }

        /* Dark Theme Variables */
        :root[data-theme="dark"] {
            --bg-primary: #0f0f0f;
            --bg-secondary: #161616;
            --bg-accent: #1e1e1e;
            --text-primary: #f8f8f8;
            --text-secondary: #bebebe;
            --accent-color: #6e56cf;
            --accent-hover: #8a6eff;
            --accent-muted: rgba(110, 86, 207, 0.3);
            --gradient-1: linear-gradient(135deg, #6e56cf 0%, #b86eff 100%);
            --gradient-2: linear-gradient(135deg, #1e1e1e 0%, #3b3b3b 100%);
            --shadow-sm: 0 5px 15px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 10px 30px rgba(0, 0, 0, 0.4);
            --shadow-glow: 0 0 15px rgba(110, 86, 207, 0.4);
            --card-border: 1px solid #2a2a2a;
            --neon-glow: 0 0 10px rgba(110, 86, 207, 0.5), 0 0 20px rgba(110, 86, 207, 0.3);
            --header-bg: rgba(15, 15, 15, 0.9);
            --switch-bg: #333333;
            --switch-thumb: #6e56cf;
            --switch-icon-color: #ffffff;
            --footer-divider: #2a2a2a;
            --scrollbar-track: #161616;
            --scrollbar-thumb: #333333;
        }

        /* General Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            font-family: 'Montserrat', sans-serif;
            overflow-x: hidden;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        h1, h2, h3, h4, h5 {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background-color: var(--header-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 0 20px;
            border-bottom: var(--card-border);
            transition: background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            transition: color 0.5s ease;
        }

        .logo::before {
            content: "";
            display: inline-block;
            width: 12px;
            height: 12px;
            margin-right: 10px;
            background-color: var(--accent-color);
            border-radius: 50%;
            box-shadow: var(--shadow-glow);
            transition: background-color 0.5s ease, box-shadow 0.5s ease;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 40px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 16px;
            transition: all 0.3s;
            position: relative;
        }

        .nav-links a::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--accent-color);
            transition: width 0.3s;
        }

        .nav-links a:hover {
            color: var(--accent-color);
            text-shadow: var(--neon-glow);
        }

        .nav-links a:hover::after {
            width: 100%;
            box-shadow: var(--shadow-glow);
        }

        /* Theme Switch (Copied from Landing Page) */
        .theme-switch-wrapper {
            display: flex;
            align-items: center;
            margin-left: 30px;
            position: relative;
        }

        .theme-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 32px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--switch-bg);
            transition: .4s;
            border-radius: 34px;
            overflow: hidden;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background-color: var(--switch-thumb);
            transition: .4s;
            border-radius: 50%;
            z-index: 2;
        }

        /* Switch icons */
        .slider .switch-icon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1;
            color: var(--switch-icon-color);
            transition: opacity 0.3s, transform 0.5s;
        }

        .slider .sun-icon {
            right: 9px;
            opacity: 1;
        }

        .slider .moon-icon {
            left: 7px;
            opacity: 0;
        }

        input:checked + .slider .sun-icon {
            opacity: 0;
        }

        input:checked + .slider .moon-icon {
            opacity: 1;
        }

        input:checked + .slider {
            background-color: var(--accent-color);
        }

        input:focus + .slider {
            box-shadow: 0 0 1px var(--accent-color);
        }

        input:checked + .slider:before {
            transform: translateX(28px);
            background-color: var(--accent-color);
        }

        /* Mobile Menu */
        .mobile-menu-btn {
            display: none;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            margin-left: 20px;
        }

        .mobile-menu-btn span {
            height: 2px;
            width: 100%;
            background-color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .mobile-menu {
            position: fixed;
            top: 80px;
            left: 0;
            width: 100%;
            height: 0;
            background-color: var(--bg-secondary);
            overflow: hidden;
            transition: height 0.3s ease;
            z-index: 99;
            opacity: 0;
            box-shadow: var(--shadow-md);
        }

        .mobile-menu.active {
            height: auto;
            opacity: 1;
            box-shadow: var(--shadow-md);
            border-bottom: var(--card-border);
        }

        .mobile-menu ul {
            list-style: none;
            padding: 20px;
        }

        .mobile-menu li {
            margin: 15px 0;
        }

        .mobile-menu a {
            font-size: 18px;
            color: var(--text-primary);
            text-decoration: none;
            transition: color 0.3s;
            display: block;
            padding: 10px 0;
        }

        .mobile-menu a:hover {
            color: var(--accent-color);
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: flex;
            }
        }

        /* Blog Post Styles */
        .blog-post {
            padding: 80px 0;
        }

        .blog-post-title {
            font-size: 42px;
            margin-bottom: 30px;
            text-align: center;
            color: var(--text-primary);
            transition: color 0.5s ease;
        }

        .blog-post-meta {
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 40px;
            transition: color 0.5s ease;
        }

        .blog-post-meta span {
            margin: 0 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .blog-post-meta i {
            color: var(--accent-color);
        }

        .blog-post-image {
            max-width: 800px;
            margin: 0 auto 40px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .blog-post-image img {
            width: 100%;
            display: block;
        }

        .blog-post-content {
            max-width: 800px;
            margin: 0 auto;
            font-size: 18px;
            line-height: 1.8;
            color: var(--text-primary);
            transition: color 0.5s ease;
        }

        .blog-post-content h2 {
            font-size: 32px;
            margin: 40px 0 20px;
        }

        .blog-post-content h3 {
            font-size: 26px;
            margin: 30px 0 15px;
        }

        .blog-post-content p {
            margin-bottom: 25px;
        }

        .blog-post-content ul,
        .blog-post-content ol {
            padding-left: 30px;
            margin-bottom: 25px;
        }

        .blog-post-content li {
            margin-bottom: 10px;
        }

        .blog-post-content a {
            color: var(--accent-color);
            text-decoration: none;
            transition: color 0.3s;
        }

        .blog-post-content a:hover {
            color: var(--accent-hover);
        }

        .blog-post-content blockquote {
            border-left: 5px solid var(--accent-color);
            padding: 15px 20px;
            margin: 30px 0;
            background-color: var(--bg-accent);
            border-radius: 5px;
            font-style: italic;
            color: var(--text-secondary);
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        .blog-post-content pre {
            background-color: var(--bg-accent);
            color: var(--text-primary);
            padding: 15px;
            overflow-x: auto;
            border-radius: 8px;
            margin-bottom: 20px;
            white-space: pre-wrap;
            word-break: break-all;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        .blog-post-content code {
            font-family: monospace, monospace;
            font-size: 16px;
            display: block;
        }

        .blog-post-content pre code {
            background: none;
            padding: 0;
            font-size: 16px;
            color: var(--text-primary);
            display: block;
        }

        .blog-post-content p code {
            background-color: var(--bg-accent);
            padding: 3px 6px;
            border-radius: 4px;
            font-family: monospace, monospace;
            font-size: 14px;
            color: var(--text-primary);
            transition: background-color 0.5s ease, color 0.5s ease;
            display: inline;
        }

        .highlight {
            background: linear-gradient(120deg, var(--accent-muted) 0%, var(--accent-muted) 100%);
            padding: 25px;
            border-left: 4px solid var(--accent-color);
            margin: 30px 0;
            border-radius: 0 8px 8px 0;
            transition: background 0.5s ease;
        }

        /* Footer */
        footer {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            padding: 80px 0 40px;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 50px;
        }

        .footer-logo {
            flex: 0 0 30%;
        }

        .footer-logo h3 {
            font-size: 28px;
            margin-bottom: 20px;
            color: var(--text-primary);
            transition: color 0.5s ease;
        }

        .footer-logo p {
            color: var(--text-secondary);
            margin-bottom: 25px;
            font-size: 15px;
            transition: color 0.5s ease;
        }

        .footer-links {
            flex: 0 0 20%;
        }

        .footer-links h4 {
            font-size: 20px;
            margin-bottom: 25px;
            position: relative;
            padding-bottom: 12px;
            color: var(--text-primary);
            transition: color 0.5s ease;
        }

        .footer-links h4::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background-color: var(--accent-color);
        }

        .footer-links ul {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: var(--accent-color);
        }

        .footer-divider {
            height: 1px;
            background-color: var(--footer-divider);
            margin: 20px 0;
            transition: background-color 0.5s ease;
        }

        .footer-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copyright {
            color: var(--text-secondary);
            font-size: 14px;
            transition: color 0.5s ease;
        }

        .footer-social {
            display: flex;
            gap: 15px;
        }

        .footer-social a {
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-accent);
            border-radius: 50%;
            border: var(--card-border);
            color: var(--text-secondary);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .footer-social a:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--accent-color);
            border-radius: 50%;
            transform: scale(0);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: -1;
        }

        .footer-social a:hover {
            color: white;
            transform: translateY(-3px);
            box-shadow: var(--shadow-glow);
            border-color: var(--accent-color);
        }

        .footer-social a:hover:before {
            transform: scale(1);
        }

        .footer-social a i {
            position: relative;
            z-index: 2;
        }

        /* Back to top button */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--accent-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-md);
            transition: all 0.3s, opacity 0.5s, transform 0.5s;
            z-index: 99;
            opacity: 0;
            transform: translateY(20px);
            text-decoration: none;
        }

        .back-to-top.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .back-to-top:hover {
            background-color: var(--accent-hover);
            transform: translateY(-5px) scale(1.05);
            box-shadow: var(--shadow-glow);
        }

        /* Theme transition overlay */
        .theme-transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-primary);
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }
         /* Custom scrollbar */
         ::-webkit-scrollbar {
            width: 12px;
            height: 12px; /* Added height for horizontal scrollbar */
        }

        ::-webkit-scrollbar-track {
            background: var(--scrollbar-track);
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--scrollbar-thumb);
            border-radius: 6px;
            border: 3px solid var(--scrollbar-track);
            transition: background-color 0.5s ease;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-color);
        }

          /* Prefers color scheme media query */
        @media (prefers-color-scheme: dark) {
            body:not([data-theme-forced="light"]) {
                --bg-primary: #0f0f0f;
                --bg-secondary: #161616;
                --bg-accent: #1e1e1e;
                --text-primary: #f8f8f8;
                --text-secondary: #bebebe;
                --shadow-glow: 0 0 15px rgba(110, 86, 207, 0.4);
                --card-border: 1px solid #2a2a2a;
                --neon-glow: 0 0 10px rgba(110, 86, 207, 0.5), 0 0 20px rgba(110, 86, 207, 0.3);
                --header-bg: rgba(15, 15, 15, 0.9);
                --switch-bg: #333333;
                --switch-thumb: #6e56cf;
                --switch-icon-color: #ffffff;
                --footer-divider: #2a2a2a;
                --scrollbar-track: #161616;
                --scrollbar-thumb: #333333;
            }
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .footer-content {
                flex-wrap: wrap;
                gap: 40px;
            }

            .footer-logo {
                flex: 0 0 100%;
                margin-bottom: 20px;
            }

            .footer-links {
                flex: 0 0 calc(50% - 20px);
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .mobile-menu-btn {
                display: flex;
            }
            
            .mobile-menu {
                border-top: 1px solid var(--card-border);
            }
            
            .blog-post-title {
                font-size: 36px;
            }

            .blog-post-content {
                font-size: 16px;
            }

            .blog-post-content h2 {
                font-size: 28px;
            }

            .blog-post-content h3 {
                font-size: 22px;
            }

            .footer-bottom {
                flex-direction: column;
                gap: 20px;
            }
        }
    </style>
</head>
<body data-theme="light">

    <!-- Theme transition overlay -->
    <div class="theme-transition-overlay" id="themeOverlay"></div>

    <!-- Header -->
    <header>
        <div class="container">
            <nav>
                <a href="/" class="logo">Samir Adhikari</a>
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li><a href="/blog.html">Blog</a></li>
                </ul>
                <!-- Mobile Menu Button -->
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </nav>
        </div>
    </header>

     <!-- Mobile Menu -->
     <div class="mobile-menu" id="mobileMenu">
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/blog.html">Blog</a></li>
        </ul>
    </div>

    <!-- Blog Post Section -->
    <section class="blog-post">
        <div class="container">
            <h1 class="blog-post-title">Building Production-Ready REST APIs with API Gateway and Lambda</h1>
            <div class="blog-post-meta">
                <span><i class="far fa-calendar-alt"></i> July 15, 2025</span>
                <span><i class="far fa-user"></i> Samir Adhikari</span>
                <span><i class="far fa-clock"></i> 12 min read</span>
                <span><i class="fas fa-tags"></i> Serverless, API Gateway, Lambda</span>
            </div>

            <div class="blog-post-content">
                <p>Building scalable REST APIs has never been easier with AWS's serverless architecture. In this comprehensive guide, we'll explore how to create production-ready APIs using Amazon API Gateway and AWS Lambda, covering everything from basic setup to advanced security and performance optimizations.</p>

                <h2>Why Choose Serverless for REST APIs?</h2>

                <p>Serverless APIs offer several compelling advantages:</p>
                <ul>
                    <li><strong>Cost Efficiency:</strong> Pay only for actual requests, not idle server time</li>
                    <li><strong>Auto-scaling:</strong> Handle traffic spikes without manual intervention</li>
                    <li><strong>No Server Management:</strong> Focus on business logic, not infrastructure</li>
                    <li><strong>High Availability:</strong> Built-in redundancy across multiple AZs</li>
                    <li><strong>Fast Development:</strong> Quick deployment and iteration cycles</li>
                </ul>

                <h2>Architecture Overview</h2>

                <p>Our serverless API architecture consists of:</p>
                <ul>
                    <li><strong>API Gateway:</strong> Entry point for all requests with built-in features like throttling, caching, and authentication</li>
                    <li><strong>Lambda Functions:</strong> Business logic execution in multiple runtime environments</li>
                    <li><strong>DynamoDB:</strong> Serverless database for data persistence</li>
                    <li><strong>IAM:</strong> Fine-grained access control</li>
                    <li><strong>CloudWatch:</strong> Monitoring and logging</li>
                </ul>

                <h2>Setting Up Your First Serverless API</h2>

                <h3>1. Create the Lambda Function</h3>

                <p>Here's a simple Lambda function that handles basic CRUD operations:</p>

                <pre><code>def lambda_handler(event, context):
    http_method = event['httpMethod']
    
    if http_method == 'GET':
        return get_users()
    elif http_method == 'POST':
        return create_user(event)
    
    return {'statusCode': 404, 'body': 'Not Found'}

def create_user(event):
    body = json.loads(event['body'])
    # Save to DynamoDB
    table.put_item(Item={'userId': str(uuid.uuid4()), 'name': body['name']})
    return {'statusCode': 201, 'body': 'User created'}
</code></pre>

                <p>The Lambda function routes requests based on HTTP methods and handles business logic like validation and database operations.</p>

                <h3>2. Create DynamoDB Table</h3>

                <p>You can quickly create a DynamoDB table using the AWS CLI or Console. The key is choosing the right partition key (in our case, <code>userId</code>) for efficient data access.</p>

                <h3>3. Configure API Gateway</h3>

                <p>API Gateway acts as the front door to your Lambda functions. You can set it up through the AWS Console or use Infrastructure as Code tools like SAM or Terraform. Key configurations include:</p>
                <ul>
                    <li>Define your API endpoints (GET, POST, PUT, DELETE)</li>
                    <li>Set up CORS for web applications</li>
                    <li>Configure rate limiting and throttling</li>
                    <li>Enable API keys for access control</li>
                </ul>

                <h2>Advanced Security Implementation</h2>

                <h3>API Key and Rate Limiting</h3>

                <p>Protecting your API is crucial. API Gateway provides built-in features for:</p>
                <ul>
                    <li><strong>API Keys:</strong> Identify and track API consumers</li>
                    <li><strong>Usage Plans:</strong> Set quotas and throttle limits per client</li>
                    <li><strong>Rate Limiting:</strong> Prevent abuse with configurable request limits</li>
                </ul>

                <p>A typical setup might allow 1,000 requests per second with a burst capacity of 2,000 requests, and a monthly quota of 100,000 requests per API key.</p>

                <h3>JWT Token Validation</h3>

                <p>For user authentication, implement JWT token validation in your Lambda function:</p>

                <pre><code>def validate_token(event):
    token = event['headers'].get('Authorization', '').replace('Bearer ', '')
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=['HS256'])
        return payload
    except jwt.ExpiredSignatureError:
        return None
</code></pre>

                <p>This ensures only authenticated users can access protected endpoints.</p>

                <h2>Performance Optimization Strategies</h2>

                <div class="highlight">
                    <h3>Key Performance Tips:</h3>
                    <ul>
                        <li><strong>Connection Pooling:</strong> Reuse database connections across Lambda invocations to reduce latency</li>
                        <li><strong>Provisioned Concurrency:</strong> Keep functions warm for critical endpoints to eliminate cold starts</li>
                        <li><strong>Right-size Memory:</strong> Balance cost and performance by choosing optimal Lambda memory allocation</li>
                        <li><strong>API Gateway Caching:</strong> Cache frequent GET requests to reduce backend load</li>
                        <li><strong>Efficient Queries:</strong> Use DynamoDB indexes and query patterns wisely</li>
                    </ul>
                </div>

                <p>A well-optimized serverless API can handle thousands of requests per second with sub-second response times while keeping costs minimal.</p>

                <h2>Monitoring and Observability</h2>

                <p>AWS provides powerful tools for monitoring your serverless APIs:</p>

                <h3>CloudWatch Metrics and Alarms</h3>
                <ul>
                    <li><strong>Error Rates:</strong> Track 4XX and 5XX errors to catch issues early</li>
                    <li><strong>Latency:</strong> Monitor response times to ensure good user experience</li>
                    <li><strong>Throttling:</strong> Alert when rate limits are being hit</li>
                    <li><strong>Cost Anomalies:</strong> Detect unexpected spikes in usage</li>
                </ul>

                <h3>X-Ray Tracing</h3>
                <p>Enable AWS X-Ray to visualize request flows through your serverless architecture. This helps identify bottlenecks and optimize performance across your entire application stack.</p>

                <h2>Deployment and CI/CD</h2>

                <p>Automate your deployment process for faster, more reliable releases:</p>

                <h3>Deployment Best Practices</h3>
                <ul>
                    <li><strong>Infrastructure as Code:</strong> Use AWS SAM, CloudFormation, or Terraform</li>
                    <li><strong>Automated Testing:</strong> Run unit and integration tests before deployment</li>
                    <li><strong>Staged Rollouts:</strong> Deploy to dev/staging environments first</li>
                    <li><strong>Rollback Strategy:</strong> Keep previous versions for quick rollbacks if needed</li>
                </ul>

                <p>Tools like AWS CodePipeline, GitHub Actions, or GitLab CI/CD can automate the entire process from code commit to production deployment.</p>

                <h2>Cost Optimization Best Practices</h2>

                <ul>
                    <li><strong>Right-size Lambda memory:</strong> Use AWS Lambda Power Tuning to find optimal settings</li>
                    <li><strong>Implement caching:</strong> Cache responses at API Gateway level for frequently accessed data</li>
                    <li><strong>Use DynamoDB On-Demand:</strong> Pay for what you use instead of provisioned capacity</li>
                    <li><strong>Monitor and alert:</strong> Set up billing alarms and cost monitoring</li>
                    <li><strong>Optimize cold starts:</strong> Use provisioned concurrency only where needed</li>
                </ul>

                <h2>Advanced Best Practices for Production APIs</h2>

                <p>Beyond the fundamentals, these advanced considerations will help you build truly production-grade serverless APIs that are secure, performant, and cost-optimized.</p>

                <h3>HTTP APIs vs REST APIs: Making the Right Choice</h3>

                <p>AWS API Gateway offers two distinct API types, and choosing the right one significantly impacts your costs, performance, and available features:</p>

                <h4>HTTP APIs (API Gateway v2) - Recommended for Most Use Cases</h4>
                <p>HTTP APIs are the newer, streamlined option designed for modern serverless applications:</p>
                <ul>
                    <li><strong>70% Lower Cost:</strong> HTTP APIs cost $1.00 per million requests compared to $3.50 for REST APIs—a substantial saving for high-traffic applications</li>
                    <li><strong>Reduced Latency:</strong> Optimized architecture delivers 50-100ms faster response times on average</li>
                    <li><strong>Native JWT Support:</strong> Built-in JWT authorization without custom Lambda authorizers, reducing complexity and cost</li>
                    <li><strong>Automatic CORS Handling:</strong> Simplified CORS configuration with single-line setup</li>
                    <li><strong>WebSocket Support:</strong> Enables real-time bidirectional communication for chat, notifications, and live updates</li>
                </ul>

                <h4>REST APIs (API Gateway v1) - For Advanced Features</h4>
                <p>REST APIs provide comprehensive features for complex enterprise requirements:</p>
                <ul>
                    <li><strong>API Key Management:</strong> Built-in API keys with usage plans for client identification and rate limiting</li>
                    <li><strong>Request Validation:</strong> Schema-based validation at the gateway level before invoking Lambda functions</li>
                    <li><strong>Request/Response Transformation:</strong> Modify payloads using Velocity Template Language (VTL)</li>
                    <li><strong>Edge-Optimized Endpoints:</strong> CloudFront distribution for global low-latency access</li>
                    <li><strong>Private APIs:</strong> VPC endpoint integration for secure internal services</li>
                    <li><strong>AWS WAF Integration:</strong> Direct Web Application Firewall protection against common exploits</li>
                </ul>

                <h4>Decision Framework</h4>
                <pre><code>Choose HTTP APIs when:
✓ Building new APIs from scratch
✓ Cost optimization is a priority  
✓ Using OAuth 2.0 or JWT authentication
✓ Need WebSocket support for real-time features
✓ Simple proxy integrations are sufficient

Choose REST APIs when:
✓ Require API key management and usage plans
✓ Need request/response transformations via VTL
✓ Must integrate AWS WAF for security
✓ Require private API endpoints within VPC
✓ Need detailed per-method cache control</code></pre>

                <h3>Intelligent Caching Strategy</h3>

                <p>Caching dramatically reduces backend load, improves response times, and lowers costs. Implement a multi-layered caching approach:</p>

                <h4>API Gateway Cache Configuration</h4>
                <p>Enable REST API caching to store responses for frequently requested data:</p>

                <pre><code>Resources:
  ApiGatewayStage:
    Type: AWS::ApiGateway::Stage
    Properties:
      RestApiId: !Ref RestApi
      StageName: prod
      CacheClusterEnabled: true
      CacheClusterSize: '0.5'  # Options: 0.5GB to 237GB
      MethodSettings:
        - ResourcePath: /users
          HttpMethod: GET
          CachingEnabled: true
          CacheTtlInSeconds: 300  # 5 minutes
          CacheDataEncrypted: true
          
        - ResourcePath: /products
          HttpMethod: GET
          CachingEnabled: true
          CacheTtlInSeconds: 3600  # 1 hour for stable data</code></pre>

                <h4>Cache-Control Headers from Lambda</h4>
                <p>Control client-side and CDN caching behavior with appropriate headers:</p>

                <pre><code>def lambda_handler(event, context):
    # Static/public data - aggressive caching
    if event['path'] == '/api/public/products':
        return {
            'statusCode': 200,
            'headers': {
                'Content-Type': 'application/json',
                'Cache-Control': 'public, max-age=3600, s-maxage=7200',
                'ETag': generate_etag(data)
            },
            'body': json.dumps(products)
        }
    
    # User-specific data - private caching only
    if event['path'] == '/api/user/profile':
        return {
            'statusCode': 200,
            'headers': {
                'Cache-Control': 'private, max-age=300',
                'Vary': 'Authorization'
            },
            'body': json.dumps(user_data)
        }
    
    # Frequently changing data - minimal caching
    if event['path'] == '/api/live/stock-prices':
        return {
            'statusCode': 200,
            'headers': {
                'Cache-Control': 'no-cache, must-revalidate, max-age=0'
            },
            'body': json.dumps(live_data)
        }</code></pre>

                <h4>Application-Level Caching</h4>
                <p>Implement in-memory caching within Lambda for warm container reuse:</p>

                <pre><code>import time
from functools import lru_cache

# Global cache persists across warm invocations
cache_store = {}
CACHE_TTL = 300  # 5 minutes

def get_cached_data(key):
    """Retrieve data with TTL-based cache"""
    if key in cache_store:
        data, timestamp = cache_store[key]
        if time.time() - timestamp < CACHE_TTL:
            print(f"Cache hit for key: {key}")
            return data
    
    # Cache miss - fetch fresh data
    data = fetch_from_database(key)
    cache_store[key] = (data, time.time())
    return data

# LRU cache for expensive computations
@lru_cache(maxsize=256)
def calculate_recommendations(user_id, category):
    """Expensive calculation cached in memory"""
    return complex_ml_computation(user_id, category)</code></pre>

                <h4>Caching Best Practices</h4>
                <ul>
                    <li><strong>Cache Only GET Requests:</strong> POST, PUT, DELETE should never be cached</li>
                    <li><strong>Set Appropriate TTLs:</strong> Balance data freshness with cache efficiency (5 min for dynamic, 1 hour for stable)</li>
                    <li><strong>Use Cache Keys Wisely:</strong> Include query parameters in cache keys for GET requests</li>
                    <li><strong>Monitor Cache Hit Rates:</strong> Target 70%+ hit rate; adjust TTL or strategy if lower</li>
                    <li><strong>Implement Cache Invalidation:</strong> Purge specific cache entries when data updates occur</li>
                </ul>

                <h3>Timeout and Payload Size Considerations</h3>

                <p>Understanding and properly configuring limits prevents unexpected failures and ensures reliable operation:</p>

                <h4>Timeout Configuration Hierarchy</h4>

                <pre><code># API Gateway maximum timeout: 29 seconds (hard limit)
# Configure Lambda timeout slightly lower for graceful handling

Resources:
  UserFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: app.handler
      Runtime: python3.11
      Timeout: 28  # Leave 1 second buffer for API Gateway
      MemorySize: 1024</code></pre>

                <h4>Lambda Timeout Best Practices</h4>
                <ul>
                    <li><strong>API Endpoints:</strong> 3-15 seconds typical; keep synchronous operations fast</li>
                    <li><strong>Background Processing:</strong> Use asynchronous invocation or Step Functions for long-running tasks</li>
                    <li><strong>Database Queries:</strong> Set connection and query timeouts lower than Lambda timeout</li>
                    <li><strong>External API Calls:</strong> Implement aggressive timeouts (3-5 seconds) with retry logic</li>
                </ul>

                <pre><code>import boto3
from botocore.config import Config

# Configure AWS SDK with proper timeouts
config = Config(
    connect_timeout=3,
    read_timeout=5,
    retries={
        'max_attempts': 2,
        'mode': 'standard'
    }
)

dynamodb = boto3.resource('dynamodb', config=config)

# HTTP client timeout configuration
import requests

def call_external_api(url):
    try:
        response = requests.get(
            url,
            timeout=(3, 5),  # (connect, read) timeouts
            headers={'User-Agent': 'MyAPI/1.0'}
        )
        return response.json()
    except requests.Timeout:
        # Fallback or error handling
        return {'error': 'External service timeout'}</code></pre>

                <h4>Payload Size Limits</h4>

                <p>AWS imposes specific size constraints across services:</p>

                <ul>
                    <li><strong>API Gateway Request:</strong> 10 MB maximum payload size</li>
                    <li><strong>API Gateway Response:</strong> 10 MB maximum (6 MB practical due to base64 encoding)</li>
                    <li><strong>Lambda Synchronous:</strong> 6 MB request and response payload</li>
                    <li><strong>Lambda Asynchronous:</strong> 256 KB for event payload</li>
                    <li><strong>DynamoDB Item:</strong> 400 KB maximum item size</li>
                </ul>

                <h4>Handling Large Payloads</h4>
                <p>For files or data exceeding limits, use presigned S3 URLs:</p>

                <pre><code>import boto3
import uuid

s3_client = boto3.client('s3')

def upload_large_file(event, context):
    """Generate presigned URL for direct S3 upload"""
    
    file_key = f"uploads/{uuid.uuid4()}.pdf"
    
    # Generate presigned POST URL
    presigned_post = s3_client.generate_presigned_post(
        Bucket='my-upload-bucket',
        Key=file_key,
        Fields={'acl': 'private'},
        Conditions=[
            {'acl': 'private'},
            ['content-length-range', 0, 104857600]  # Max 100MB
        ],
        ExpiresIn=3600  # 1 hour validity
    )
    
    return {
        'statusCode': 200,
        'body': json.dumps({
            'uploadUrl': presigned_post['url'],
            'fields': presigned_post['fields'],
            'fileKey': file_key
        })
    }

def download_large_file(event, context):
    """Generate presigned URL for direct S3 download"""
    
    file_key = event['pathParameters']['fileKey']
    
    presigned_url = s3_client.generate_presigned_url(
        'get_object',
        Params={
            'Bucket': 'my-download-bucket',
            'Key': file_key
        },
        ExpiresIn=3600
    )
    
    return {
        'statusCode': 200,
        'body': json.dumps({'downloadUrl': presigned_url})
    }</code></pre>

                <h4>Request Size Validation</h4>
                <pre><code>def lambda_handler(event, context):
    """Validate payload size early"""
    
    body = event.get('body', '')
    
    # Check size (API Gateway base64 encodes binary data)
    if event.get('isBase64Encoded'):
        # Approximate original size
        size_bytes = len(body) * 0.75
    else:
        size_bytes = len(body)
    
    if size_bytes > 5 * 1024 * 1024:  # 5 MB threshold
        return {
            'statusCode': 413,  # Payload Too Large
            'body': json.dumps({
                'error': 'Request payload exceeds 5MB limit',
                'message': 'Use presigned S3 URL for large files'
            })
        }
    
    # Process request
    return process_data(json.loads(body))</code></pre>

                <h3>Comprehensive Security Implementation</h3>

                <p>Security must be layered across multiple dimensions to protect your APIs from threats:</p>

                <h4>AWS WAF Integration for DDoS and Attack Prevention</h4>

                <p>AWS Web Application Firewall provides protection against common web exploits and volumetric attacks:</p>

                <pre><code>Resources:
  # Create Web ACL with managed rule groups
  ApiWebACL:
    Type: AWS::WAFv2::WebACL
    Properties:
      Scope: REGIONAL
      DefaultAction:
        Allow: {}
      Rules:
        # Rate limiting per IP
        - Name: RateLimitRule
          Priority: 1
          Statement:
            RateBasedStatement:
              Limit: 2000  # 2000 requests per 5 minutes per IP
              AggregateKeyType: IP
          Action:
            Block:
              CustomResponse:
                ResponseCode: 429
          VisibilityConfig:
            SampledRequestsEnabled: true
            CloudWatchMetricsEnabled: true
            MetricName: RateLimitRule
        
        # AWS Managed Rules - Core Rule Set
        - Name: AWSManagedRulesCommonRuleSet
          Priority: 2
          Statement:
            ManagedRuleGroupStatement:
              VendorName: AWS
              Name: AWSManagedRulesCommonRuleSet
          OverrideAction:
            None: {}
          VisibilityConfig:
            SampledRequestsEnabled: true
            CloudWatchMetricsEnabled: true
            MetricName: CommonRuleSet
        
        # SQL Injection protection
        - Name: SQLiProtection
          Priority: 3
          Statement:
            ManagedRuleGroupStatement:
              VendorName: AWS
              Name: AWSManagedRulesSQLiRuleSet
          OverrideAction:
            None: {}
          VisibilityConfig:
            SampledRequestsEnabled: true
            CloudWatchMetricsEnabled: true
            MetricName: SQLiProtection
        
        # Known bad inputs protection
        - Name: KnownBadInputsRuleSet
          Priority: 4
          Statement:
            ManagedRuleGroupStatement:
              VendorName: AWS
              Name: AWSManagedRulesKnownBadInputsRuleSet
          OverrideAction:
            None: {}
          VisibilityConfig:
            SampledRequestsEnabled: true
            CloudWatchMetricsEnabled: true
            MetricName: KnownBadInputs
        
        # Geographic blocking (optional)
        - Name: GeoBlockRule
          Priority: 5
          Statement:
            GeoMatchStatement:
              CountryCodes:
                - CN  # Block specific countries if needed
                - RU
          Action:
            Block: {}
          VisibilityConfig:
            SampledRequestsEnabled: true
            CloudWatchMetricsEnabled: true
            MetricName: GeoBlockRule
      
      VisibilityConfig:
        SampledRequestsEnabled: true
        CloudWatchMetricsEnabled: true
        MetricName: ApiWebACL

  # Associate WAF with API Gateway
  WebACLAssociation:
    Type: AWS::WAFv2::WebACLAssociation
    Properties:
      ResourceArn: !Sub 'arn:aws:apigateway:${AWS::Region}::/restapis/${RestApi}/stages/prod'
      WebACLArn: !GetAtt ApiWebACL.Arn</code></pre>

                <h4>API Keys and Usage Plans</h4>

                <p>Implement client identification and rate limiting with API keys:</p>

                <pre><code>Resources:
  # Create usage plan with throttling
  ApiUsagePlan:
    Type: AWS::ApiGateway::UsagePlan
    Properties:
      UsagePlanName: StandardPlan
      Description: Standard API access with rate limits
      Throttle:
        BurstLimit: 100  # Max concurrent requests
        RateLimit: 50    # Sustained requests per second
      Quota:
        Limit: 10000     # Total requests per period
        Period: DAY
      ApiStages:
        - ApiId: !Ref RestApi
          Stage: !Ref ProdStage

  # Create API key
  ApiKey:
    Type: AWS::ApiGateway::ApiKey
    Properties:
      Name: ClientApiKey
      Description: API key for external client
      Enabled: true

  # Associate key with usage plan
  UsagePlanKey:
    Type: AWS::ApiGateway::UsagePlanKey
    Properties:
      KeyId: !Ref ApiKey
      KeyType: API_KEY
      UsagePlanId: !Ref ApiUsagePlan</code></pre>

                <p>Validate API keys in your Lambda functions for additional security:</p>

                <pre><code>def lambda_handler(event, context):
    """Validate API key and client permissions"""
    
    api_key = event['headers'].get('x-api-key')
    
    if not api_key:
        return {
            'statusCode': 401,
            'body': json.dumps({'error': 'API key required'})
        }
    
    # Validate key against DynamoDB or Secrets Manager
    if not validate_api_key(api_key):
        return {
            'statusCode': 403,
            'body': json.dumps({'error': 'Invalid API key'})
        }
    
    # Process authorized request
    return process_request(event)</code></pre>

                <h4>Amazon Cognito Integration for User Authentication</h4>

                <p>Implement secure user authentication with Amazon Cognito User Pools:</p>

                <pre><code>Resources:
  # Create Cognito User Pool
  UserPool:
    Type: AWS::Cognito::UserPool
    Properties:
      UserPoolName: ApiUserPool
      AutoVerifiedAttributes:
        - email
      Schema:
        - Name: email
          Required: true
          Mutable: false
      Policies:
        PasswordPolicy:
          MinimumLength: 12
          RequireUppercase: true
          RequireLowercase: true
          RequireNumbers: true
          RequireSymbols: true

  # User Pool Client
  UserPoolClient:
    Type: AWS::Cognito::UserPoolClient
    Properties:
      ClientName: ApiClient
      UserPoolId: !Ref UserPool
      GenerateSecret: false
      ExplicitAuthFlows:
        - ALLOW_USER_PASSWORD_AUTH
        - ALLOW_REFRESH_TOKEN_AUTH

  # API Gateway Authorizer
  CognitoAuthorizer:
    Type: AWS::ApiGateway::Authorizer
    Properties:
      Name: CognitoAuthorizer
      Type: COGNITO_USER_POOLS
      IdentitySource: method.request.header.Authorization
      RestApiId: !Ref RestApi
      ProviderARNs:
        - !GetAtt UserPool.Arn</code></pre>

                <p>Access authenticated user information in Lambda:</p>

                <pre><code>def lambda_handler(event, context):
    """Access Cognito user claims"""
    
    # Extract user identity from Cognito authorizer
    claims = event['requestContext']['authorizer']['claims']
    
    user_id = claims['sub']  # Cognito user ID
    email = claims['email']
    username = claims['cognito:username']
    
    # Implement user-specific logic
    user_data = get_user_data(user_id)
    
    return {
        'statusCode': 200,
        'body': json.dumps({
            'user': email,
            'data': user_data
        })
    }</code></pre>

                <h4>Security Best Practices Checklist</h4>
                <ul>
                    <li>✓ <strong>Enable HTTPS Only:</strong> API Gateway enforces TLS 1.2+ by default</li>
                    <li>✓ <strong>Use AWS WAF:</strong> Protect against OWASP Top 10 vulnerabilities</li>
                    <li>✓ <strong>Implement Rate Limiting:</strong> Prevent abuse with throttling and burst limits</li>
                    <li>✓ <strong>Validate Input:</strong> Sanitize all user inputs at gateway and Lambda levels</li>
                    <li>✓ <strong>Least Privilege IAM:</strong> Grant minimal permissions to Lambda execution roles</li>
                    <li>✓ <strong>Encrypt Sensitive Data:</strong> Use AWS KMS for encryption at rest</li>
                    <li>✓ <strong>Enable Access Logging:</strong> Log all API requests to CloudWatch or S3</li>
                    <li>✓ <strong>Use Secrets Manager:</strong> Never hardcode credentials or API keys</li>
                    <li>✓ <strong>CORS Configuration:</strong> Restrict origins to trusted domains only</li>
                    <li>✓ <strong>Monitor Security Events:</strong> Set up CloudWatch alarms for suspicious activity</li>
                </ul>

                <h2>Conclusion</h2>

                <p>Building production-ready REST APIs with API Gateway and Lambda provides a scalable, cost-effective solution for modern applications. By implementing proper security measures, performance optimizations, and monitoring, you can create APIs that handle millions of requests while maintaining low latency and high availability.</p>

                <p>The serverless approach eliminates infrastructure management overhead, allowing you to focus on delivering business value. With the patterns and best practices covered in this guide, you're equipped to build robust serverless APIs that scale seamlessly with your application's growth.</p>

                <div class="highlight">
                    <p><strong>Next Steps:</strong> Try implementing these patterns in your own projects, and consider extending the API with additional features like WebSocket support using API Gateway v2, or implementing GraphQL endpoints for more flexible data fetching.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h3>Samir Adhikari</h3>
                    <p>A blog dedicated to sharing AWS insights, DevOps practices, and cloud solution strategies.</p>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/blog.html">Blog</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Categories</h4>
                    <ul>
                        <li><a href="#">AWS</a></li>
                        <li><a href="#">DevOps</a></li>
                        <li><a href="#">Cloud Solutions</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Contact</h4>
                    <ul>
                        <li><a href="mailto:samir.adhh@email.com">samir.adhhh@gmail.com</a></li>
                        <li><a href="#">9861762422</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-divider"></div>
            <div class="footer-bottom">
                <div class="copyright">© 2025 Samir Adhikari. All rights reserved.</div>                <div class="footer-social">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>                </div>
                </div>
        </div>
    </footer>

    <!-- Back to top button -->
    <a href="#" class="back-to-top" id="backToTopBtn">
        <i class="fas fa-arrow-up"></i>
    </a>

    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Theme Toggle ---
            const checkbox = document.getElementById('checkbox');
            const themeOverlay = document.getElementById('themeOverlay');

            function showThemeTransition() {
                if (themeOverlay) {
                    themeOverlay.style.display = 'block';
                    themeOverlay.style.opacity = '1';
                    setTimeout(() => {
                        themeOverlay.style.opacity = '0';
                        setTimeout(() => {
                            themeOverlay.style.display = 'none';
                        }, 500);
                    }, 500);
                }
            }

            function setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
            }

            if (checkbox) {
                checkbox.addEventListener('change', () => {
                    const theme = checkbox.checked ? 'dark' : 'light';
                    showThemeTransition();
                    setTheme(theme);
                });
            }

            const storedTheme = localStorage.getItem('theme');
            if (storedTheme) {
                setTheme(storedTheme);
                if (checkbox) checkbox.checked = storedTheme === 'dark';
            } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                setTheme('dark');
                if (checkbox) checkbox.checked = true;
            }

             // --- Back to Top Button ---
             const backToTopBtn = document.getElementById('backToTopBtn');
            if (backToTopBtn) {
                window.addEventListener('scroll', () => {
                    backToTopBtn.classList.toggle('visible', window.pageYOffset > 300);
                });

                backToTopBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }

            // --- Mobile Menu ---
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');

            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', () => {
                    mobileMenu.classList.toggle('active');
                });
            }
        });
    </script>
</body>
</html>